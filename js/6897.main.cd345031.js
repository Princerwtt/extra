"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[6897],{661174:function(e,t,n){var r=n(667294),o=n(380955),a=n(569041),l=n(825615),c=n(774756),i=(0,o.Pi)((function(e){var t=e.path,n=e.clickEvent,o=e.onClick,i=e.className,u=e.style,s=e.children,d=(0,a.si)({path:t,skipAppPreviewPage:"loggedIn",storeToOpenOnDesktop:null}),p=d.appLink,f=d.copyLinkToClipboard,m=(0,c.U)((function(e){n&&(0,l.L9)(n),o&&o(e),f()}),[n,f,o]);return r.createElement("a",{href:p,className:i,style:u,onClick:m},s)}));t.Z=i},237690:function(e,t,n){n.d(t,{Z:function(){return y}});var r=n(487462),o=n(145987),a=n(215671),l=n(143144),c=n(360136),i=n(182963),u=n(661120),s=n(667294),d=n(294184),p=n.n(d),f=n(985020),m=n(546922),g=n(55977),h=(n(732208),["onClick","className","buttonClassName"]);function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.Z)(e);if(t){var o=(0,u.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,i.Z)(this,n)}}var y=function(e){(0,c.Z)(n,e);var t=v(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.className,a=(e.buttonClassName,(0,o.Z)(e,h));return s.createElement("div",(0,r.Z)({className:p()("ModalBodyBackButton__container",n)},a),s.createElement(m.ZP,{faIcon:f.A3,onClick:t,color:"flat",size:g.q.mdLg,screenReaderLabel:"Close",className:"ModalBodyBackButton__button align-items-center justify-content-center",clickEvent:null}))}}]),n}(s.PureComponent);y.displayName="ModalBodyBackButton"},174420:function(e,t,n){var r=n(487462),o=n(204942),a=n(193324),l=n(145987),c=n(667294),i=n(687167),u=n(916746),s=n(733612),d=["defaultValue","onToggleSelected","options","lightGrayIfSelected"];function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=function(e){var t,n=e.defaultValue,o=e.onToggleSelected,p=e.options,m=e.lightGrayIfSelected,g=(0,l.Z)(e,d),h=(0,c.useState)(!1),v=(0,a.Z)(h,2),y=v[0],b=v[1],k=(0,i.OT)(y,b),O=(0,u.K)(o),P=null!==n?n:p.length>0?p[0].value:null,S=p.some((function(e){return e.selected}));t=S?k:O(P);var E=(0,c.useMemo)((function(){return p.map((function(e){return f(f({},e),{},{action:{onClick:O(e.value),event:null}})}))}),[O,p]);return c.createElement(s.Z,(0,r.Z)({},g,{clickAction:(0,c.useMemo)((function(){return t?{onClick:t,event:null}:null}),[t]),options:E,isMenuOpen:y,onIsMenuOpenChange:b,color:S&&m?"light-gray":e.color}))};m.displayName="SplitDropdownSelect",m=c.memo(m),t.Z=m},334880:function(e,t,n){var r=n(667294),o=n(132634),a=n(380955),l=n(48048),c=n(546922),i=n(950250),u=n(821835),s=n(98921),d=n(55977),p=(0,a.Pi)((function(e){var t=e.canOpenTooltip,n=e.onClick,a=(0,u.Fe)().setValue,p="dismissedLodgingWebTooltip";return r.createElement(l.Z,{canOpen:t,fade:!0,dismissedKey:p,heading:"Find hotels",body:"Browse and book hotels near the places you want to visit",positionFixed:!0,isAutomaticallyTriggered:!0},r.createElement(c.ZP,{color:"translucent-black",faIcon:o.by,faIconProps:{size:"1x"},size:d.q.mdLg,shadow:!0,layout:"inline",onClick:(0,r.useCallback)((function(){a(p,!0),n()}),[a,n]),clickEvent:i.j.clickFindHotelsNonPromo,eventProperties:{source:s.nm.mapButton}}))}));t.Z=p},446532:function(e,t,n){var r,o=n(487462),a=n(115861),l=n(215671),c=n(143144),i=n(360136),u=n(182963),s=n(661120),d=n(667294),p=n(380955),f=n(79068),m=n(321043),g=n(611224),h=n(180411),v=n(337144),y=n(120773);function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.Z)(e);if(t){var o=(0,s.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var k=(0,p.Pi)(r=function(e){(0,i.Z)(r,e);var t,n=b(r);function r(){var e;(0,l.Z)(this,r);for(var t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return(e=n.call.apply(n,[this].concat(o))).state={loading:!0,error:null,googlePlaceListId:null,showGoogleMaps:!1,showLoginOrSubscribeModal:!1},e.handleOpenInGoogleMaps=function(){var t=e.props,n=t.auth,r=t.toggle;e.setState({showLoginOrSubscribeModal:!0});var o=n.maybeShowLoginOrSubscribeModal({openedFrom:"GoogleMapsExportModal",firstFeatureCard:y.vX.exportToGoogleMaps}),a=o.success,l=o.failure;a.then((function(){setTimeout((function(){e.setState({showGoogleMaps:!0,showLoginOrSubscribeModal:!1})}),300)})),l.then((function(){setTimeout((function(){e.setState({showLoginOrSubscribeModal:!1}),r()}),300)}))},e.handleBack=function(){e.setState({showGoogleMaps:!1})},e}return(0,c.Z)(r,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.loadData()}},{key:"componentDidUpdate",value:function(e){!e.isOpen&&this.props.isOpen&&this.loadData()}},{key:"loadData",value:(t=(0,a.Z)(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.tripPlanKey,this.setState({loading:!0,error:null}),e.prev=2,e.next=5,(0,f.xV)(t);case 5:return n=e.sent,e.next=8,(0,h.gw)(5e3);case 8:this.setState({loading:!1,googlePlaceListId:n}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),(0,m.l3)(this,"error","loading")(e.t0);case 14:case"end":return e.stop()}}),e,this,[[2,11]])}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this.props.isOpen,t=this.state.showLoginOrSubscribeModal;return d.createElement(g.Z,(0,o.Z)({},this.props,this.state,{onOpenInGoogleMaps:this.handleOpenInGoogleMaps,isOpen:e&&!t,onBack:this.handleBack}))}}]),r}(d.PureComponent))||r;k.displayName="GoogleMapsExportModal",t.Z=(0,v.fm)(k)},611224:function(e,t,n){var r=n(667294),o=n(810684),a=n(120627),l=n(535951),c=n(725468),i=n(446830),u=n(291843),s=n(661174),d=n(953330),p=n(715887),f=n(950250),m=n(300559),g=n(771380),h=n(546922),v=n(237690),y=n(556406),b=n(936848),k=n(55977),O=(n(52877),r.memo((function(e){var t=e.isOpen,n=e.loading,O=e.googlePlaceListId,P=e.error,S=e.tripPlanKey,E=e.showGoogleMaps,M=e.onOpenInGoogleMaps,w=e.onBack,x=e.toggle;return r.createElement(p.Z,{isOpen:t,toggle:x,size:E?"md":"sm",isAutomaticallyTriggered:!1},r.createElement(o.Z,{className:"pt-2 px-0"},r.createElement(g.Z,{onClick:x}),E&&r.createElement(v.Z,{onClick:w}),r.createElement("div",{className:"GoogleMapsExportModalInner__heading m-4"},r.createElement("div",{className:"text-center"},"View in app")),r.createElement("div",{className:"GoogleMapsExportModalInner__body"},r.createElement(a.Z,{isOpen:!E},r.createElement("div",{className:"text-center"},r.createElement("div",{className:"d-none d-sm-flex justify-content-center"},r.createElement(m.Z,{className:"mr-2",type:m.N.ios,clickEvent:f.j.getIosAppExportModal}),r.createElement(m.Z,{type:m.N.android,clickEvent:f.j.getAndroidAppExportModal})),r.createElement(s.Z,{className:"btn btn-lg btn-primary btn-block d-flex d-sm-none align-items-center",path:(0,b.Ll)({key:S,title:"",includeHost:!1}),clickEvent:f.j.openInAppLink},r.createElement(u.Z,{src:"/assets/logo.png",alt:"",className:"btn-image"}),r.createElement("div",{className:"flex-grow-1 ml-3"},"Open in the ",d.aD," app")),r.createElement("div",{className:"mt-2 text-muted"},"See your full document with your notes, reservations, and places on a map"),r.createElement("hr",{className:"my-4"}),r.createElement(y.Z,{label:"Open in Google Maps",imageIconSrc:"/assets/GoogleMapsLogo_32x32.png",onClick:M,clickEvent:f.j.openInGoogleMaps,layout:"block",size:k.q.lg,color:"gray"}),r.createElement("div",{className:"mt-2 text-muted"},"View only your saved places as markers on a map")))),r.createElement(a.Z,{isOpen:E},r.createElement("div",{className:"px-4"},P?r.createElement(i.Z,{color:"danger",response:P}):r.createElement(r.Fragment,null,r.createElement("p",null,"In Google Maps,"," ",r.createElement("strong",{className:"text-info"},'click the "Follow" button')," ","to save the list"),r.createElement("div",{className:"text-center mb-4"},r.createElement(u.Z,{src:"/assets/GoogleMapsExportModal__howTo.png",alt:"Click the Follow button",className:"GoogleMapsExportModalInner__howTo"})),r.createElement("div",{className:"text-center"},r.createElement(a.Z,{isOpen:n},r.createElement("div",{className:"mb-4"},"We're exporting your places to Google Maps"),r.createElement(l.Z,{seconds:5,done:!n})),r.createElement(a.Z,{isOpen:!n},r.createElement(h.ZP,{className:"btn btn-lg btn-primary",target:"_blank",label:"Open in Google Maps",imageIconSrc:"/assets/GoogleMapsLogo_32x32.png",color:"primary",size:k.q.lg,to:O&&E?(0,c.R)(O):void 0,clickEvent:null})),r.createElement("div",{className:"mt-4"},"Google Maps takes up to a minute to update the place lists. Wait a few seconds and reload Google Maps if you don't see all the places you've added")))))))})));t.Z=O},795933:function(e,t,n){var r=n(789062),o=n(667294),a=n(441145),l=n(192580),c=n(177654),i=n(668774),u=n(62069),s=n(774756),d=n(916746),p=n(127059),f=n(950250),m=o.memo((function(e){var t=e.sections,n=e.checkedSectionIds,a=e.onCheckedSectionIdsChange,m=e.onExpand,h=(0,i.zF)(t,c.a1,(0,u.bE)()),v=(0,s.U)((function(e,t){a(t?[].concat((0,r.Z)(n),[e]):n.filter((function(t){return t!==e})))}),[n,a]),y=(0,d.K)(v),b=(0,o.useMemo)((function(){return{type:"button",onClick:m,clickEvent:f.j.expandMapLayers}}),[m]);return o.createElement(o.Fragment,null,h.slice(0,2).map((function(e){return o.createElement(l.Z,{key:e.id,section:e,isChecked:n.includes(e.id),onIsCheckedChange:y(e.id)})})),h.length>2&&o.createElement(p.Z,{iconProps:g,text:"Expand for more",action:b}))})),g={icon:a.pt,size:"1x"};t.Z=m},801142:function(e,t,n){var r=n(667294),o=n(232817),a=n(950250),l=n(546922),c=n(55977),i=(n(274442),r.memo((function(e){var t=e.onClick,n=e.indicatorCount;return r.createElement("div",{className:"position-relative"},null!=n&&r.createElement("div",{className:"MapLayersButton__indicatorContainer d-flex justify-content-center align-items-center"},r.createElement("span",{className:"MapLayersButton__indicator font-weight-bold"},n)),r.createElement(l.ZP,{color:"translucent-black",faIcon:o.Kr,faIconProps:{size:"lg"},size:c.q.mdLg,shadow:!0,layout:"inline",onClick:t,clickEvent:a.j.openMapLayers}))})));t.Z=i},937721:function(e,t,n){n.d(t,{b:function(){return r}});var r,o=n(487462),a=n(145987),l=n(667294),c=n(743033),i=n(950250),u=n(241396),s=n(912980),d=(n(737468),n(154886)),p=n(795933),f=n(687167),m=["title","mode","onModeChange"];!function(e){e.hidden="hidden",e.compact="compact",e.large="large"}(r||(r={}));var g=l.memo((function(e){var t=e.title,n=e.mode,g=e.onModeChange,h=(0,a.Z)(e,m),v=(0,f.vA)(g,r.large);return l.createElement(c.Z,{in:n!==r.hidden},l.createElement(u.Z,{title:t||"Map layers",onDismiss:(0,f.vA)(g,r.hidden),dismissEvent:i.j.closeMapLayers,dismissOnOutsideClick:!0,className:"MapLayersOverlay"},n===r.compact?l.createElement(p.Z,(0,o.Z)({onExpand:v},h)):l.createElement(d.Z,h),n!==r.hidden&&l.createElement(s.Z,null)))}));t.Z=g},566897:function(e,t,n){var r=n(487462),o=n(204942),a=n(193324),l=n(145987),c=n(667294),i=n(730381),u=n.n(i),s=n(120627),d=n(810405),p=n(4868),f=n(862563),m=n(837401),g=n(925596),h=n(898422),v=n(620083),y=n(582336),b=n(381846),k=n(216505),O=n(918915),P=n(912980),S=n(845594),E=n(531232),M=n(833827),w=(n(868690),n(597894)),x=n(916746),I=n(304678),Z=n(774756),C=n(164676),j=n(906626),L=n(408605),B=n(878927),T=["placeSections","defaultBoundsGeo","selectedBlock","placeMetadata","showOnlySectionId","onShowOnlySectionIdChange","onPlacesListClick","selectedPlaceDisplayMode","saveButton","onLoginAfterSaveClick","addMarginToOverlays","planMapWebMapRef","componentsToHide"];function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=c.createElement("div",{className:"PlanMapInnerSidebar__mapElement"}),D=c.memo((function(e){var t=e.placeSections,n=e.defaultBoundsGeo,o=e.selectedBlock,i=e.placeMetadata,N=e.showOnlySectionId,D=e.onShowOnlySectionIdChange,F=e.onPlacesListClick,z=e.selectedPlaceDisplayMode,U=e.saveButton,W=e.onLoginAfterSaveClick,H=e.addMarginToOverlays,K=e.planMapWebMapRef,V=e.componentsToHide,Y=(0,l.Z)(e,T),q=e.selectedItem,Q=e.onSelectedItemChange,X=e.overlays,J=e.edgeInsets,$=(0,w.dr)(),ee=(0,L.UW)(),te=ee.lastPlaceAddedSectionId,ne=ee.onAddedPlaceToSection,re={componentsToHide:V},oe=z||"full-width",ae=(0,c.useState)(null),le=(0,a.Z)(ae,2),ce=le[0],ie=le[1],ue=(0,j.k)(),se=ue.planMapPlaceCardHeight,de=ue.planMapPlaceCardContainerRef,pe=ue.setPlanMapPlaceCardHeight,fe=(0,x.t)(D);(0,c.useEffect)((function(){var e=null!=N&&t.find((function(e){return e.id===N}));e&&ie((0,f.eN)(e,{fillUntitled:!1,datePreference:$.datePreference}))}),[t,$.datePreference,N]);var me=(0,c.useRef)(null),ge=(0,I.uX)((function(){var e=me.current?{width:me.current.clientWidth,height:me.current.clientHeight}:{width:500,height:500},r=(0,m.Yl)(t);if(n){var o=n.latitude,a=n.longitude,l=n.bounds;if(l){var c=(0,O.cG)(l,e),i=(0,E.qg)(l);return{lngLat:{longitude:i.longitude,latitude:i.latitude},zoom:c}}return{lngLat:{longitude:a||0,latitude:o||0},zoom:11}}if(1===r.length){var u=r[0];return{lngLat:{longitude:u.longitude,latitude:u.latitude},zoom:11}}var s=(0,E.zX)(r),d=(0,E.qg)(s);return{lngLat:{longitude:d.longitude,latitude:d.latitude},zoom:(0,O.cG)(s,e)+1}}),[t,n]),he=(0,Z.U)((function(){Q(null)}),[Q]),ve=(0,Z.U)((function(e,n){var r=(0,d.OQ)(q);if(U&&"togglePlaceButton"===U.type){var o=U.onTogglePlace;if(q&&"googlePlace"in q&&e===r&&o){if(!q.googlePlace)throw new Error("A place object is required to toggle whether a place is in lists");var a=n.sectionId;"add"===(0,h.LA)({placeId:e,sections:t,sectionId:a})&&ne(a);var l="existing"===q.type?q.blockId:null;o(n,q.googlePlace,l)}}}),[ne,t,U,q]),ye=(0,c.useMemo)((function(){if(null==N)return t;var e,n=t.find((function(e){return e.id===N})),r=null;return n&&n.date&&(r=n.date,e=u().utc(n.date,"YYYY-MM-DD")),t.map((function(t){var n=(0,m.bv)(t.blocks,v.k.place);return t.id===N?t:t.type===p.bA.hotels?A(A({},t),{},e?{blocks:G(n,e)}:{blocks:[]}):t.type===p.bA.flights?A(A({},t),{},e?{blocks:R(n,r)}:{blocks:[]}):A(A({},t),{},{blocks:[]})}))}),[t,N]),be=null!=N&&t.find((function(e){return e.id===N})),ke="expandable"===oe?b.Z:S.Z,Oe="expandable"===oe&&o&&o.type!==v.k.checklist&&o.text,Pe=(0,b.H)({selectedItem:q,datePreference:$.datePreference,placeMetadata:i,placeSections:t}),Se=!!Pe,Ee=null;Pe&&(Ee=c.createElement(ke,(0,r.Z)({},re,Pe,{text:Oe||null,imageKey:o&&o.type===v.k.place?(0,y.U_)(o):Pe.imageKey||null,onPlacesListClick:F,topChildren:c.createElement(M.Z,{onLoginAfterSaveClick:W,saveButton:U,onSectionToggle:ve,lastPlaceAddedSectionId:te,placeMetadata:i,selectedItem:Pe.selectedPlace}),onClose:he,onHeightChange:pe,saveButton:U})));var Me=(0,c.useMemo)((function(){var e;return A(A({},J),{},{bottom:Math.max(null!==(e=null==J?void 0:J.bottom)&&void 0!==e?e:0,Ee&&"expandable"!==oe?se:0)})}),[se,Ee,J,oe]),we=(0,c.useMemo)((function(){return{bottom:"expandable"===oe?k.F:0}}),[oe]),xe=(0,c.useMemo)((function(){switch(oe){case"expandable":return c.createElement("div",{ref:de,className:"PlanMapInnerSidebar__selectedCard PlanMapInnerSidebar__selectedCardMapEmbed py-3 px-2 d-flex flex-column align-items-start justify-content-end"},Ee);case"full-width":return c.createElement("div",{ref:de,className:"PlanMapInnerSidebar__selectedCard py-3 px-3 d-flex flex-column justify-content-end"},c.createElement("div",{className:"PlanMapInnerSidebar__selectedCardInner d-flex flex-column justify-content-end"},Se&&c.createElement(P.Z,null),q&&("new"===q.type||"existing"===q.type)&&q.loading&&c.createElement("div",{className:"text-center text-muted p-3"},c.createElement(g.Z,{size:"2x"})),Ee));case"none":return null;default:return(0,B.j)(oe),null}}),[de,Ee,q,oe,Se]),Ie=(0,c.useMemo)((function(){return c.createElement(c.Fragment,null,H&&Ee?c.createElement("div",{style:{position:"absolute",inset:0,marginBottom:se}},X):X,xe)}),[H,se,Ee,xe,X]);return c.createElement("div",{className:"row m-0 h-100"},c.createElement("div",{className:"p-0 d-flex flex-column col-12 h-100"},c.createElement(s.Z,{isOpen:!!be&&!!fe},c.createElement("button",{className:"btn btn-block btn-white rounded-0",type:"button",onClick:fe?fe(null):void 0},"Showing only “",ce||"Untitled section","” places. ",c.createElement("strong",{className:"text-primary"},"Show all places"))),c.createElement(C.Z,(0,r.Z)({},Y,{ref:K,defaultCenter:ge.lngLat,defaultZoom:ge.zoom,className:"flex-grow-1",mapElement:_,placeSections:ye,panInsets:we,overlays:Ie,edgeInsets:Me}))))}));function G(e,t){return e.filter((function(e){if(e.hotel&&e.hotel.checkIn&&e.hotel.checkOut){var n=u().utc(e.hotel.checkIn,"YYYY-MM-DD"),r=u().utc(e.hotel.checkOut,"YYYY-MM-DD");return t>=n&&t<=r}return!1}))}function R(e,t){return e.filter((function(e){return!(!e.date||!t)&&t===e.date}))}t.Z=D},833827:function(e,t,n){var r=n(667294),o=n(612690),a=n(806019),l=n(661493),c=n(916746),i=n(868607),u=n(727646),s=n(401905),d=n(655179),p=n(760225),f=n(546922),m=n(950250),g=n(55977),h=n(878927),v=r.memo((function(e){var t=e.saveButton,n=e.selectedItem,v=e.placeMetadata,y=e.onLoginAfterSaveClick,b=e.lastPlaceAddedSectionId,k=e.onSectionToggle,O=(0,r.useMemo)((function(){return n&&"googlePlace"in n&&n.googlePlace?(0,s.gM)(n.googlePlace):null}),[n]),P=(0,r.useMemo)((function(){return O?v[O.placeId]:null}),[v,O]),S=(0,c.K)(k);if(!t)return null;switch(t.type){case"togglePlaceButton":return O&&!n.omitSectionDropdownSelect?r.createElement(i.Z,{placeSections:t.existingSections,placeId:O.placeId,onSectionToggle:S(O.placeId),lastPlaceAddedSectionId:b,positionFixed:!0,size:g.q.sm,color:"brand",lightGrayIfSelected:!0,addToTripPlanType:t.addToTripPlanType}):null;case"outsideTripPlanSaveButton":return n.googlePlace&&O?r.createElement(u.Z,{onLoginAfterSaveClick:y,placeId:(0,s.Bz)(n.googlePlace),mapPlaceId:(null==P?void 0:P.id)||null,text:(0,d.UM)((null==P?void 0:P.description)||"")}):null;case"saveButton":return r.createElement(p.Z,{icon:a.Gg,center:!0},r.createElement(f.ZP,{className:"my-2",loading:!!t.isSaveButtonLoading,faIcon:t.isSaved?o.xV:l.xV,label:t.isSaved?"Saved":"Save",onClick:t.onToggleSavePlace,color:t.isSaved?"light-gray":"dark",size:g.q.sm,clickEvent:t.isSaved?null:m.j.addSelectedPlace}));default:return(0,h.j)(t),null}}));t.Z=v},164676:function(e,t,n){var r=n(487462),o=n(115861),a=n(204942),l=n(193324),c=n(145987),i=n(667294),u=n(357267),s=n(759545),d=n(380955),p=n(446532),f=n(810405),m=n(597464),g=n(128182),h=n(546922),v=n(950250),y=n(956228),b=n(801142),k=n(937721),O=n(304678),P=n(334880),S=n(862056),E=n(556406),M=n(337144),w=n(565738),x=n(774756),I=n(687167),Z=n(621501),C=n(457510),j=n(743033),L=n(813990),B=n(158748),T=n(559257),N=n(55977),A=n(403287),_=(n(480374),n(19315)),D=n(538865),G=n(878927),R=n(597894),F=n(789124),z=["onExistingPlaceSelect","onSelectedItemChange","placeSections","onNonMarkerClick","selectedItem","isOpen","overlays","exportToGoogleMapsTripPlanKey","tripPlanType","className","mapElement","onFindHotelsClick","onExitMap","hideMapLayersButton","alwaysShowRouteLines","onAlwaysShowRouteLinesToggle","mapComponent","showRouteLinesBetweenSections","distancesBetweenPlaces","onOptimizeRouteClick","edgeInsets","onBoundsChanged","initialMapLayersOverlayMode","mapLayersOverlayTitle","deemphasizedTripPlanSections"];function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,a=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw a}}}}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var V=(0,d.Pi)(i.forwardRef((function(e,t){var n,a=e.onExistingPlaceSelect,d=e.onSelectedItemChange,U=e.placeSections,K=e.onNonMarkerClick,V=e.selectedItem,q=e.isOpen,Q=e.overlays,X=e.exportToGoogleMapsTripPlanKey,J=e.tripPlanType,$=e.className,ee=e.mapElement,te=e.onFindHotelsClick,ne=e.onExitMap,re=e.hideMapLayersButton,oe=e.alwaysShowRouteLines,ae=e.onAlwaysShowRouteLinesToggle,le=e.mapComponent,ce=e.showRouteLinesBetweenSections,ie=e.distancesBetweenPlaces,ue=e.onOptimizeRouteClick,se=e.edgeInsets,de=e.onBoundsChanged,pe=e.initialMapLayersOverlayMode,fe=e.mapLayersOverlayTitle,me=e.deemphasizedTripPlanSections,ge=(0,c.Z)(e,z),he=(0,M.tN)().user,ve=(0,y.jK)(),ye=(0,A.lS)().itineraryOptions,be=null!==(n=null==ye?void 0:ye.defaultTravelMode)&&void 0!==n?n:null,ke=(0,R.dr)().datePreference,Oe=(0,i.useState)(!1),Pe=(0,l.Z)(Oe,2),Se=Pe[0],Ee=Pe[1],Me=(0,i.useState)(null),we=(0,l.Z)(Me,2),xe=we[0],Ie=we[1],Ze=(0,i.useRef)(null),Ce=(0,i.useState)(!1),je=(0,l.Z)(Ce,2),Le=je[0],Be=je[1],Te=(0,i.useState)(null!=pe?pe:k.b.hidden),Ne=(0,l.Z)(Te,2),Ae=Ne[0],_e=Ne[1],De=(0,x.U)((function(e){(0,B.Am)({text:e,color:B.PQ.default})}),[]),Ge=(0,x.U)((function(e){tt.current&&tt.current.fitBounds(e)}),[]),Re=(0,I.vA)(d,null),Fe=(0,L.n)({stateBounds:xe,latestBoundsRef:Ze,showToast:De,fitBounds:Ge,clearSelectedItem:Re,onSelectItem:d}),ze=Fe.search,Ue=Fe.shouldShowSearchAgain,We=Fe.searchState,He=Fe.currentSearch,Ke=Fe.clearSearch,Ve=Fe.handleSearchAgain,Ye=(0,i.useRef)(U);(0,i.useEffect)((function(){var e=new Set("done"===(null==We?void 0:We.status)?We.result.map((function(e){return e.placeId})):[]),t=!!(V&&V.isPlace&&e.has(V.googlePlaceId));if(Ye.current&&!t)if(Ye.current.length!==U.length)Ke();else{var n,r=H(U.entries());try{for(r.s();!(n=r.n()).done;){var o=(0,l.Z)(n.value,2),a=o[0],c=o[1];if(Ye.current[a].blocks.length!==c.blocks.length){Ke();break}}}catch(e){r.e(e)}finally{r.f()}}Ye.current=U}),[Ke,U,We,V]),(0,i.useImperativeHandle)(t,(function(){return{searchPlace:ze,clearSearch:Ke}}));var qe=me||U,Qe=(0,F.Z)(qe,X),Xe=Qe.hiddenSectionIds,Je=Qe.onCheckedSectionIdsChange,$e=Qe.indicatorCount,et=Qe.checkedSectionIds,tt=(0,i.useRef)(null),nt=We&&("inProgress"===We.status||"done"===We.status),rt=(0,O.uX)((function(){var e=null,t=U;return"done"===(null==We?void 0:We.status)&&We.result.length>0&&He?e=W({type:"unaddedPlaces",places:We.result},(0,_.z)(He)):me&&(e={type:"placesList",placesList:{boardSections:U,title:""}},t=me),(0,g.Ix)(t,{type:J,selectedItem:V,deviceId:null,excludedSectionIds:Xe,alwaysShowRouteLines:oe,showRouteLinesBetweenSections:!!ce,distancesBetweenPlaces:ie,overlayMarkers:e,defaultTravelMode:be,datePreference:ke})}),[oe,He,ke,be,ie,Xe,U,We,V,ce,J,me]),ot=(0,i.useMemo)((function(){return(0,g.rH)(V,rt)}),[rt,V]),at=!!ve&&(0,S.Q_)(ve),lt=(0,x.U)((function(e){var t=e.listIndex,n=e.placeIndex,r=(0,g.Bl)(e,U);if(r)switch(r.type){case"flight":case"rentalCar":case"train":case"bus":case"existing":return void a(r.googlePlaceId,at);case"block":return void d(r);case"new":return;default:throw(0,G.j)(r)}else if(e.place.placeId){var o=rt[t];d((0,f._v)({placeId:e.place.placeId,marker:(0,m.wd)({list:o,placeIndex:n})}))}}),[at,rt,a,d,U]),ct=(0,w.Nr)((0,x.U)((function(e){Ie(e),de&&de(e)}),[de]),1e3),it=(0,x.U)((function(e){ct(e),Ze.current=e}),[ct]),ut=(0,x.U)((function(){_e(k.b.hidden),K&&K()}),[K]),st=(0,x.U)(function(){var e=(0,o.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=2;break}return e.abrupt("return");case 2:if(!V||"new"!==V.type||V.googlePlaceId!==t){e.next=4;break}return e.abrupt("return");case 4:d((0,f._v)({placeId:t,marker:null}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[d,V]),dt=(0,x.U)((function(){Ee(!0)}),[]),pt={className:$,mapElement:ee},ft=(0,I.vA)(_e,k.b.large),mt=(0,i.useMemo)((function(){return i.createElement("div",{className:"PlanMapWebMap__topLeftBtns"},ne&&i.createElement(h.ZP,{className:"PlanMapWebMap__exitBtn p-2",color:"translucent-black",faIcon:s.NB,shadow:!0,labelTextClassName:"ml-1",label:"Exit map",onClick:ne,clickEvent:v.j.exitFullScreenMap}))}),[ne]),gt=(0,i.useMemo)((function(){return i.createElement("div",{className:"PlanMapWebMap__topRightBtns d-flex flex-column align-items-end"},X&&i.createElement(E.Z,{className:"PlanMapWebMap__exportBtn px-3",color:"translucent-black",shadow:!0,size:N.q.mdLg,label:(0,S.Q_)(ve)?"Export":void 0,screenReaderLabel:"Export to Google Maps",imageIconSrc:"/assets/GoogleMapsLogo_32x32.png",onClick:dt,clickEvent:v.j.openExportMapModal}),!re&&i.createElement("div",{className:"mt-2 position-relative"},i.createElement(b.Z,{onClick:ft,indicatorCount:$e}),i.createElement(k.Z,{title:fe,sections:qe,mode:Ae,onModeChange:_e,checkedSectionIds:et,onCheckedSectionIdsChange:Je,alwaysShowRouteLines:oe,onAlwaysShowRouteLinesToggle:ae,onMapLayerGroupSelect:null})),te&&i.createElement("div",{className:"mt-2"},i.createElement(P.Z,{onClick:te,canOpenTooltip:Le&&q})))}),[X,ve,dt,re,ft,$e,fe,qe,Ae,et,Je,oe,ae,te,Le,q]),ht=(0,i.useMemo)((function(){return i.createElement("div",{style:{position:"relative",top:null==se?void 0:se.top}},i.createElement("div",{className:"PlanMapWebMap__topMiddleBtns d-flex flex-column align-items-center"},We&&He&&i.createElement(i.Fragment,null,i.createElement(C.Z,{search:He,loading:"inProgress"===We.status,clickEvent:null,onClick:Ke}),i.createElement(j.Z,{in:Ue},i.createElement(h.ZP,{clickEvent:null,onClick:Ve,color:"dark",label:"Search this area",className:"mt-2"})))),!nt&&i.createElement(i.Fragment,null,gt,mt))}),[null==se?void 0:se.top,We,He,Ke,Ue,Ve,nt,gt,mt]),vt=W(W({},ge),{},{edgeInsets:se,overlays:i.createElement(i.Fragment,null,Q,ht),onBoundsChanged:it,onNonMarkerClick:ut}),yt=W(W(W({},pt),vt),{},{fitMarkersOnMount:!0,markerLists:rt,onMarkerClick:lt,selectedMarkerIndexes:ot,checkedMarkerIndexes:Y,onDragStart:ut,onDragEnd:(0,I.vA)(Be,!0),panToNewPlace:!1}),bt=(0,x.U)((function(e){var t=tt.current;t&&t.panToPlace(e)}),[]);(0,T.J)({placeSections:U,panToPlace:bt});var kt=(0,I.vA)(Ee,!1),Ot=(0,i.useMemo)((function(){return ue?{label:"Optimize route",faIcon:u.Fp,clickEvent:v.j.clickOptimizeRouteButtonOnMap,onClick:ue,badge:(0,Z.ox)(he)?"pro":void 0}:null}),[he,ue]);return i.createElement(i.Fragment,null,"isGoogleMapsWithMarkers"in le&&le.isGoogleMapsWithMarkers?i.createElement(le,(0,r.Z)({},yt,{ref:tt,onMapIconClick:st,enableClustering:J===D.u.story,extraMapBottomButtonProps:Ot})):i.createElement(le,yt),X&&i.createElement(p.Z,{isOpen:Se,toggle:kt,tripPlanKey:X}))}))),Y=[];t.Z=V},457510:function(e,t,n){var r=n(667294),o=n(759545),a=n(546922),l=(n(18593),n(158718)),c=r.memo((function(e){var t=e.onClick,n=e.clickEvent,c=e.search,i=e.loading,u=(0,l.N)(c),s=u.unboldedPrefix,d=u.searchText;return r.createElement(a.ZP,{clickEvent:n,label:r.createElement(r.Fragment,null,r.createElement("b",{className:"mr-1"},s,":"),r.createElement("span",{className:"font-weight-normal mr-2"},d)),faRightIcon:i?"loading":o.NB,color:"translucent-black",onClick:t,className:"SearchPlaceOverlayButton"})}));t.Z=c},868607:function(e,t,n){var r=n(487462),o=n(145987),a=n(215671),l=n(143144),c=n(360136),i=n(182963),u=n(661120),s=n(667294),d=n(130845),p=n(923450),f=n.n(p),m=n(842494),g=n(612690),h=n(661493),v=n(4868),y=n(862563),b=n(892958),k=n(174420),O=n(882100),P=n(538865),S=n(597894),E=["placeSections","onSectionToggle","placeId","addToTripPlanType","lastPlaceAddedSectionId","color","lightGrayIfSelected"];function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.Z)(e);if(t){var o=(0,u.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,i.Z)(this,n)}}var w={label:"New list",icon:m.FG},x=function(e){(0,c.Z)(n,e);var t=M(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).getSections=(0,d.Z)((function(e,t,n){return e.filter((function(e){return e.type===v.bA.normal})).map((function(e){return{value:e.id,label:(0,y.eN)(e,{dateFormat:y.fh.shortDayOfTheWeekAndTextMonth,datePreference:n}),icon:m.FG,iconProps:{color:e.placeMarkerColor},selected:(0,O.S0)(t,e.blocks)}}))})),e.sections=function(){return e.getSections(e.props.placeSections,e.props.placeId,e.props.sessionPreferences.datePreference)},e.handleToggleSelected=function(t){var n=e.props.onSectionToggle;t&&n({new:!1,sectionId:t})},e.handleEnteredFreeformOption=function(t){(0,e.props.onSectionToggle)({new:!0,sectionId:(0,b.u)(),heading:t||""})},e.renderLabel=function(){var t=e.props.addToTripPlanType,n=e.sections().filter((function(e){return e.selected}));return 1===n.length?"Added":n.length>1?"Added to ".concat(n.length," ").concat(f()("list",n.length)):t===P.u.recommendations?"Add to guide":"Add to trip"},e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props,t=(e.placeSections,e.onSectionToggle,e.placeId,e.addToTripPlanType,e.lastPlaceAddedSectionId),n=e.color,a=e.lightGrayIfSelected,l=(0,o.Z)(e,E);return s.createElement(k.Z,(0,r.Z)({label:this.renderLabel(),defaultValue:t,onToggleSelected:this.handleToggleSelected,options:this.sections(),freeformOption:w,onEnterFreeformOption:this.handleEnteredFreeformOption,color:n,lightGrayIfSelected:a,icon:h.xV,selectedIcon:g.xV},l))}}]),n}(s.PureComponent);x.displayName="SectionDropdownSelect",t.Z=(0,S.xz)(x)},408605:function(e,t,n){n.d(t,{UW:function(){return i},_P:function(){return l},kO:function(){return c},oj:function(){return a}});var r=n(667294),o=(0,n(898784).J)({lastPlaceAddedSectionId:null,onAddedPlaceToSection:function(){}},{name:"WithPlanPageLastPlaceAdded"}),a=o.withProps,l=o.Context,c=o.ContextProvider;function i(){return(0,r.useContext)(l)}},622688:function(e,t,n){n.d(t,{G:function(){return r}});var r=110},645392:function(e,t,n){n.d(t,{F8:function(){return s},QU:function(){return u},b3:function(){return r}});var r,o=n(667294),a=n(622688),l=n(774756),c=n(825615),i=n(950250),u=160;a.G;function s(e){var t=(0,o.useRef)(!1);return(0,l.U)((function(){t.current||(t.current=!0,(0,c.L9)(i.j.viewHotelBookingEntryPoint,{entryPoint:e}))}),[e])}!function(e){e.reservationEmails="Reservation emails",e.mapButton="Map button",e.itineraryDays="Itinerary days",e.homeBottomButton="Home bottom button",e.explore="Explore",e.homePage="Home page",e.hotelLandingPage="Hotel landing page",e.hotelLandingPageFooter="Hotel landing page footer",e.explorePage="Explore page",e.importEmailsModal="Import emails modal",e.placesListPage="Places list page"}(r||(r={}))},882100:function(e,t,n){n.d(t,{S0:function(){return u}});var r=n(620083),o=n(769867),a=n(737168),l=n(401905),c=n(878927);function i(e){return(0,a.Vo)(function(e){var t,n;switch(e.type){case r.k.place:return[e.place];case r.k.rentalCar:return[e.pickUp.place,e.dropOff.place];case r.k.flight:return[null===(t=e.depart.airport)||void 0===t?void 0:t.googlePlace,null===(n=e.arrive.airport)||void 0===n?void 0:n.googlePlace].filter(o.B);case r.k.bus:case r.k.train:return[e.depart.place,e.arrive.place];case r.k.attachment:case r.k.note:case r.k.checklist:return[];case r.k.story:return[e.place].filter(o.B);default:return(0,c.j)(e),[]}}(e),(function(e){return(0,l.Bz)(e)}))}function u(e,t){return t.some((function(t){return(n=t,i(n).map((function(e){return(0,l.Bz)(e)}))).includes(e);var n}))}},98921:function(e,t,n){n.d(t,{eD:function(){return P},l5:function(){return O},nm:function(){return r}});var r,o=n(385564),a=n.n(o),l=n(610928),c=n.n(l),i=n(730381),u=n.n(i),s=n(401905),d=n(4868),p=n(837401),f=n(620083),m=n(188155),g=n(769867),h=n(254308),v=n(645392),y=n(538865);function b(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,a=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw a}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){var n,r=b(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(o.checkIn<=t&&t<o.checkOut)return o}}catch(e){r.e(e)}finally{r.f()}return null}function P(e){var t=e.itinerary,n=(0,m.CG)(t.sections,y.u.plan),r=a()(n.map((function(e){return e.blocks.filter((function(e){return e.type===f.k.place&&e.hotel}))}))).map((function(e){return"hotel"in e&&e.hotel||null})).filter(g.B);return function(e){var t,n=e.dayPlanSections,r=e.existingHotels,o=[],a=null,l=n.length>0?n[n.length-1].date:null,i=b(n.slice(0,-1));try{for(i.s();!(t=i.n()).done;){var d=t.value;if(d.date)if(S(d.date,r))a&&(a.checkOut=d.date,o.push(a),a=null);else{var m=c()((0,p.bv)(d.blocks,f.k.place));if(a){if(m){var g=m.place.geometry.location,h=g.lat,y=g.lng;a.place?(0,s.lP)(a.place.longitude,a.place.latitude,y,h)>v.QU&&(a.checkOut=d.date,o.push(a),a={checkIn:d.date,checkOut:d.date,place:{latitude:h,longitude:y}}):a.place={latitude:h,longitude:y}}}else if(a={checkIn:d.date,checkOut:d.date,place:null},m){var k=m.place.geometry.location,O=k.lat,P=k.lng;a.place={latitude:O,longitude:P}}}}}catch(e){i.e(e)}finally{i.f()}a&&l&&(a.checkOut=l,o.push(a));for(var E=u()().format("YYYY-MM-DD"),M=0;M<o.length;M++)if(o[M].checkOut>E){o[M].checkIn<E&&(o[M].checkIn=E);break}return o.slice(M)}({dayPlanSections:n.filter((function(e){return e.mode===d.cd.dayPlan&&e.date})),existingHotels:r})}function S(e,t){var n,r=b(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;if((0,h.jY)(o,e))return!0}}catch(e){r.e(e)}finally{r.f()}return!1}!function(e){e.importEmailsModal="Import emails modal",e.mapButton="Map button",e.hotelsSectionList="Hotels section list"}(r||(r={}))},60506:function(e,t,n){n.d(t,{x:function(){return c}});var r=n(204942),o=n(270425);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e){var t=e.place,n=e.userId,r=e.text,a=e.imageKeys,c=e.savedFrom,i=n?{type:"user",userId:n}:{type:"unknown"},u=(0,o.md)(t,i);return r&&(u.text=r),a&&(u.imageKeys=a),c&&(u.savedFrom=l(l({},c),{},{saveFromBlogText:u.text})),u}},898422:function(e,t,n){n.d(t,{LA:function(){return S},xO:function(){return M}});var r=n(789062),o=n(204942),a=n(655179),l=n(669417),c=n(4868),i=n(639086),u=n(837401),s=n(620083),d=n(769867),p=n(818455),f=n(537276),m=n(60506),g=n(737168),h=n(538865);function v(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,a=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw a}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e){var t=e.sections,n=e.sectionId,o=e.placeId,a=t.map((function(e,t){var r=e.blocks;return(n?e.id===n:r.some((function(e){return P(e,o)})))?t:null})).filter(d.B);if(0===a.length)return[];var c,i=[],u=v(a);try{var s=function(){var e=c.value,n=t[e].blocks,a=(0,r.Z)(n.map((function(e,t){return P(e,o)?t:null})).filter(d.B)).reverse();i.push.apply(i,(0,r.Z)(a.map((function(r){return(0,l.vO)((0,f.n)(t,[e,"blocks",r]),n[r])}))))};for(u.s();!(c=u.n()).done;)s()}catch(e){u.e(e)}finally{u.f()}return i}function P(e,t){if(e.type===s.k.flight||e.type===s.k.rentalCar||e.type===s.k.note||e.type===s.k.bus||e.type===s.k.train||e.type===s.k.attachment||e.type===s.k.checklist)return null;var n=e.place;return n?("placeId"in n?n.placeId:n.place_id)===t:null}function S(e){var t=e.sections,n=e.placeId,r=e.sectionId;if(r){var o=t.find((function(e){return e.id===r}));return o&&o.blocks.some((function(e){return P(e,n)}))?"remove":"add"}return t.some((function(e){return e.blocks.some((function(e){return P(e,n)}))}))?"remove":"add"}function E(e,t){var n=(0,u.NO)(e).filter((function(e){return e.place.place_id===t&&!(0,a.xb)(e.text)}));return 0!==n.length?(0,g.mF)(n,(function(e){return-(0,a.as)(e.text).length}))[0].text:null}function M(e){var t=e.place,n=e.sections,r=e.section.sectionId,o=t.place_id;if("add"===S({placeId:o,sections:n,sectionId:r||null})){var a=e.text;return a||(a=E(n,t.place_id)),k(k({},function(e){var t=e.sections,n=e.section,r=e.userId,o=e.place,a=e.text,u=e.imageKeys,s=e.addDuplicates,d=e.savedFrom,g=(0,m.x)({place:o,userId:r,text:a,imageKeys:u,savedFrom:d});if(n.new){var v=k(k({},(0,i.eC)(t)),{},{heading:n.heading,blocks:[g]}),y=(0,p.Q9)(t,h.u.plan);return{ops:[(0,l.QO)((0,f.n)(t,[y]),v)],placeBlock:g,section:v,index:0}}var b=n.sectionId,O=n.sectionId?t.findIndex((function(e){return e.id===b})):t.findIndex((function(e){return e.type===c.bA.normal}));if(-1===O)return{ops:[],placeBlock:null,section:null,index:null};var S,E,M=t[O],w=M.blocks,x=w.findIndex((function(e){return P(e,o.place_id)}));return-1===x||s?(E=w.length,S=[(0,l.QO)((0,f.n)(t,[O,"blocks",E]),g)]):(S=[],g=w[E=x]),{ops:S,placeBlock:g,section:M,index:E}}(k(k({},e),{},{text:a,imageKeys:e.imageKeys||null}))),{},{action:"add"})}return{ops:O({sections:n,placeId:o,sectionId:r||null}),section:null,placeBlock:null,index:null,action:"remove"}}},559257:function(e,t,n){n.d(t,{J:function(){return d}});var r=n(618446),o=n.n(r),a=n(667294),l=n(257833),c=n(304678),i=n(837401),u=n(128182),s=n(774756);function d(e){var t=e.placeSections,n=e.panToPlace,r=(0,a.useContext)(l.nD).contributor,d=(0,a.useRef)(null);var p=(0,c.uX)((function(){return new Set((0,i.NO)(t).map((function(e){return e.place.placeId})))}),[t]),f=(0,a.useRef)(p);return(0,a.useEffect)((function(){if(p.size===f.current.size+1){var e=(0,i.NO)(t).find((function(e){return!f.current.has(e.place.placeId)&&o()(r,e.addedBy)}));if(e&&!function(e){var t=d.current;if(!t)return!1;var n=t.placeId,r=t.toggledTimeMillis;return n===e&&Date.now()<r+5e3}(e.place.placeId)){var a=(0,u.eo)(e);a.length&&n(a[0])}}f.current=p}),[r,n,p,t]),{onPlaceToggledFromMap:(0,s.U)((function(e){d.current={placeId:e,toggledTimeMillis:Date.now()}}),[])}}},718196:function(e,t,n){n.d(t,{AW:function(){return a},Ot:function(){return l}});var r,o=n(283943);!function(e){e.restaurants="restaurants",e.attractions="attractions",e.cafes="cafes",e.desserts="desserts",e.bars="bars"}(r||(r={}));var a={[r.restaurants]:{icon:o.VE.utensils,label:"Food"},[r.attractions]:{icon:o.VE.mapMarkerAlt,label:"Attractions"},[r.cafes]:{icon:o.VE.coffee,label:"Cafes"},[r.desserts]:{icon:o.VE.iceCream,label:"Desserts"},[r.bars]:{icon:o.VE.wineGlass,label:"Bars"}},l=20},95411:function(e,t,n){n.d(t,{F:function(){return r},o:function(){return o}});var r=1e4;function o(e){return'We found no results for "'.concat(e,'"')}},19315:function(e,t,n){n.d(t,{z:function(){return c}});var r=n(718196),o=n(283943),a=n(416645),l=n(878927);function c(e){switch(e.type){case"search":return{icon:o.VE.mapMarkerAlt,color:a.Sn};case"mapLayerGroup":return{icon:r.AW[e.group].icon,color:a.QL};default:return(0,l.j)(e),{icon:o.VE.mapMarkerAlt,color:a.Sn}}}},158718:function(e,t,n){n.d(t,{N:function(){return a}});var r=n(737168),o=n(878927);function a(e){switch(e.type){case"search":return{unboldedPrefix:"Searching",searchText:e.query};case"mapLayerGroup":return{unboldedPrefix:"Exploring",searchText:(0,r.EM)(e.group)};default:return(0,o.j)(e),{unboldedPrefix:"Searching",searchText:"Unknown "}}}},257833:function(e,t,n){n.d(t,{Sh:function(){return a},nD:function(){return l},sj:function(){return o}});var r=(0,n(898784).J)({contributor:{type:"unknown"},contributors:[],ownerId:null,editors:[],onEditorChanged:function(){return null}},{name:"WithContributor"}),o=r.withProps,a=r.ContextProvider,l=r.Context},813990:function(e,t,n){n.d(t,{n:function(){return E}});var r=n(204942),o=n(115861),a=n(193324),l=n(667294),c=n(923450),i=n.n(c),u=n(531232),s=n(95411),d=n(487e3),p=n(401905),f=n(774756),m=n(825615),g=n(950250),h=n(438212),v=n(810405),y=n(718196),b=n(19315),k=n(262812),O=n(878927);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e){var t=e.stateBounds,n=e.latestBoundsRef,r=e.showToast,c=e.fitBounds,P=e.clearSelectedItem,E=e.onSelectItem,w=(0,l.useState)(null),x=(0,a.Z)(w,2),I=x[0],Z=x[1],C=(0,l.useState)(null),j=(0,a.Z)(C,2),L=j[0],B=j[1],T=(0,l.useRef)(null),N=(0,k.x)(t),A=(0,l.useState)(!1),_=(0,a.Z)(A,2),D=_[0],G=_[1],R=(0,d.Cq)((0,f.U)(function(){var e=(0,o.Z)(regeneratorRuntime.mark((function e(t,n){var o,a,l,d,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(G(!0),B(null),e.prev=2,(0,m.L9)(g.j.searchPlaces),o=M(t)){e.next=7;break}return e.abrupt("return",[]);case 7:Z(S(S({},n),o)),P(),e.t0=n.type,e.next="search"===e.t0?12:"mapLayerGroup"===e.t0?16:20;break;case 12:return e.next=14,(0,h.k6)(S(S({},n),o));case 14:return a=e.sent,e.abrupt("break",22);case 16:return e.next=18,(0,h.hL)({mapLayerGroup:n.group,bounds:t});case 18:return a=e.sent,e.abrupt("break",22);case 20:(0,O.j)(n),a=[];case 22:return 0===a.length?"search"===n.type?r((0,s.o)(n.query)):"mapLayerGroup"===n.type?r("We found no ".concat(i()(n.group)," in your current map view")):(0,O.j)(n):(l=(0,b.z)(n),E((0,v._v)({placeId:a[0].placeId,place:null,marker:{markerColor:l.color,icon:l.icon,index:0}})),"search"===n.type?r("We found ".concat(i()("result",a.length,!0),' for "').concat(n.query,'"')):"mapLayerGroup"===n.type?a.length===y.Ot?r("We found ".concat(a.length," ").concat(n.group,": zoom in to see more")):r("We found ".concat(a.length," ").concat(n.group)):(0,O.j)(n),d=a.map((function(e){return{longitude:e.longitude,latitude:e.latitude}})),p=(0,u.e4)({bounds:(0,u.zX)(d),minWidth:.01,minHeight:.01}),c(p),setTimeout((function(){var e;G(!1),B(M(null!==(e=null==N?void 0:N.current)&&void 0!==e?e:null))}),1500)),e.abrupt("return",a);case 24:return e.prev=24,setTimeout((function(){G(!1)}),2e3),e.finish(24);case 27:case"end":return e.stop()}}),e,null,[[2,,24,27]])})));return function(t,n){return e.apply(this,arguments)}}(),[P,c,N,E,r])),F=R.state,z=R.call,U=R.clearState;(0,l.useEffect)((function(){var e=(null==n?void 0:n.current)||t,r=T.current;e&&r&&(T.current=null,z(e,r))}),[z,n,t]);var W=(0,f.U)(function(){var e=(0,o.Z)(regeneratorRuntime.mark((function e(r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(o=(null==n?void 0:n.current)||t)?z(o,r):T.current=r;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[z,n,t]),H=(0,l.useMemo)((function(){var e,n,r,o,a,l,c,i,u,d,f,m,g=M(t);return!(null===I||"done"!==(null==F?void 0:F.status)||!g||L&&(e=L,n=g,a=e.longitude,l=e.latitude,c=n.longitude,i=n.latitude,u=(null!==(r=e.radiusMeters)&&void 0!==r?r:s.F)/1e3,d=(null!==(o=n.radiusMeters)&&void 0!==o?o:s.F)/1e3,f=Math.abs(u-d)/u,m=(0,p.dk)({longitude:a,latitude:l},{longitude:c,latitude:i})/u,!(f>.25||m>.25)))}),[t,I,null==F?void 0:F.status,L]),K=(0,f.U)((function(){U(),Z(null)}),[U]),V=(0,f.U)((function(){I&&W(I)}),[I,W]);return{search:(0,f.U)((function(e){return W({type:"search",query:e})}),[W]),listMapLayerGroupPlaces:(0,f.U)((function(e){return W({type:"mapLayerGroup",group:e})}),[W]),shouldShowSearchAgain:H,searchState:F,currentSearch:I,clearSearch:K,handleSearchAgain:V,doNotMoveMap:D}}function M(e){if(!e)return null;var t=(0,u.qg)(e);return{longitude:t.longitude,latitude:t.latitude,radiusMeters:1e3*(0,u.Iz)(e)}}},52877:function(){},274442:function(){},737468:function(){},732208:function(){},868690:function(){},480374:function(){},18593:function(){}}]);