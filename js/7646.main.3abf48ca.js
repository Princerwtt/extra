"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[7646],{727646:function(e,t,n){var r=n(487462),a=n(204942),o=n(115861),l=n(193324),c=n(189734),i=n.n(c),s=n(667294),u=n(380955),d=n(730381),p=n.n(d),m=n(473727),f=n(661493),g=n(612690),y=n(337144),v=n(766935),b=n(79068),E=n(158748),P=n(950250),O=n(825615),k=n(438212),S=n(487e3),Z=n(546922),w=n(821835),h=n(627406),j=n(774756),C=n(597894);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=(0,u.Pi)((function(e){var t=e.placeId,n=e.text,a=e.mapPlaceId,c=e.onLoginAfterSaveClick,i=e.buttonClassName,u=e.size,d=e.label,p=(0,y.tN)(),h=p.showLoginModal,D=p.user,N=(0,w.Fe)(),T=N.data,x=N.setValue,F=T.lastSaveToDocInfo,L=(0,C.dr)().datePreference,_=(0,s.useState)(!1),A=(0,l.Z)(_,2),U=A[0],B=A[1],M=(0,s.useState)(null),R=(0,l.Z)(M,2),V=R[0],q=R[1],H=(0,j.U)((function(){(0,O.L9)(P.j.clickSaveToDocButton),a&&c?c(a):h("register",{loginFormTo:"to bookmark places to your own trip plan"})}),[a,c,h]),z=(0,S.Cq)(b.nE),G=z.state,Q=z.call,Y=(0,S.Cq)((0,j.U)(function(){var e=(0,o.Z)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,b.dF)(t,L);case 3:return n=e.sent,e.abrupt("return",n);case 7:throw e.prev=7,e.t0=e.catch(0),q(null),x("lastSaveToDocInfo",void 0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),[L,x])),J=Y.state,W=Y.call,X=(0,j.U)((function(e){W(e),q(e)}),[W]),$=(0,s.useState)({adding:!1,addedKey:null}),ee=(0,l.Z)($,2),te=ee[0],ne=ee[1],re=(0,s.useMemo)((function(){if("done"===(null==G?void 0:G.status)){var e=G.result.find((function(e){return e.key===V}));if(e)return e.title}else if((null==F?void 0:F.tripPlanKey)===V)return F.tripPlanTitle;return null}),[F,V,G]),ae=(0,j.U)(function(){var e=(0,o.Z)(regeneratorRuntime.mark((function e(r){var a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(V){e.next=2;break}return e.abrupt("return");case 2:return a=V,e.prev=3,ne({adding:!0,addedKey:null}),(0,O.L9)(P.j.saveToDoc,{placeId:t,key:a}),x("lastSaveToDocInfo",{tripPlanKey:a,tripPlanTitle:re,sectionId:r}),e.next=9,(0,k.Vg)(t);case 9:return o=e.sent,e.next=12,(0,b.Lv)({key:a,sectionId:r,place:o,text:n,savedFrom:null});case 12:ne({adding:!1,addedKey:a}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),ne({adding:!1,addedKey:null}),(0,E.Am)({text:e.t0.message,color:E.PQ.danger});case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),[t,V,re,x,n]),oe=(0,j.U)((function(){q(null),x("lastSaveToDocInfo",void 0)}),[x]),le=(0,j.U)((function(){var e=!U;if(B(e),e){if(F){var t=F.tripPlanKey;q(t),W(t)}else q(null);Q(),(0,O.L9)(P.j.clickSaveToDocButton)}}),[U,F,W,Q]),ce=te.adding,ie=te.addedKey,se=(0,s.useMemo)((function(){var e=!!ie;return{label:ce?s.createElement("span",{className:"sr-only"},"Adding"):s.createElement("span",null,e?"Saved":"Save"),color:e?"light-gray":"dark",faIcon:e?g.xV:f.xV}}),[ie,ce]),ue=(0,s.useMemo)((function(){return I(I({},se),{},{size:u,label:null!=d?d:se.label})}),[se,d,u]),de=(0,s.useMemo)((function(){if(null===V)return null===G||"inProgress"===G.status?{mode:v.I.loading}:"error"===G.status?{mode:v.I.error,message:G.error}:K({tripPlansState:G,loadingSectionsForKey:null});if(null===J||"inProgress"===J.status)return"done"===(null==G?void 0:G.status)?K({tripPlansState:G,loadingSectionsForKey:V}):{mode:v.I.loading};if("error"===J.status)return{mode:v.I.error,message:J.error};var e=J.result,t=F&&e.find((function(e){return e.id===F.sectionId}))||null;return{mode:v.I.sections,recentSection:t,tripPlanTitle:re,sections:e,adding:te.adding}}),[te.adding,F,V,re,J,G]);return D?s.createElement("div",{className:"d-flex"},ie&&s.createElement("div",{className:"my-auto mr-3"},s.createElement(m.rU,{to:"/plan/".concat(ie)},"Open plan")),s.createElement(v.Z,(0,r.Z)({},ue,{buttonClassName:i,isOpen:U,toggle:le,dropdownState:de,onTripPlanClick:X,mapPlaceId:a,onSectionClick:ae,onBackClick:oe}))):s.createElement(Z.ZP,(0,r.Z)({},ue,{className:i,onClick:H,clickEvent:P.j.openLoginModal}))}));function K(e){var t=e.tripPlansState,n=e.loadingSectionsForKey,r=i()(t.result,(function(e){return-p()(e.editedAt).unix()})).filter((function(e){return e.keyType===h.qo.edit})).slice(0,15);return{mode:v.I.tripPlans,tripPlans:r,loadingSectionsForKey:n}}t.Z=N},766935:function(e,t,n){n.d(t,{I:function(){return r}});var r,a=n(204942),o=n(487462),l=n(145987),c=n(667294),i=n(698227),s=n(686704),u=n(465497),d=n(473727),p=n(855346),m=n(842494),f=n(440098),g=n(925596),y=n(4868),v=n(996684),b=n(505289),E=n(546922),P=n(950250),O=n(916746),k=n(472327),S=n(538865),Z=n(834702),w=n(614638),h=["buttonClassName","isOpen","toggle","dropdownState","onTripPlanClick","mapPlaceId","onSectionClick","onBackClick"];function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.loading="loading",e.error="error",e.tripPlans="tripPlans",e.sections="sections"}(r||(r={}));var D=c.memo((function(e){var t=e.buttonClassName,n=e.isOpen,a=e.toggle,j=e.dropdownState,D=e.onTripPlanClick,N=e.mapPlaceId,K=e.onSectionClick,T=e.onBackClick,x=(0,l.Z)(e,h),F=(0,O.K)(D),L=(0,O.K)(K),_=(0,c.useCallback)((function(e){return e.filter((function(e){return e.type!==y.bA.textOnly})).map((function(e){return c.createElement(i.Z,{key:e.id,onClick:L(e.id)},c.createElement("span",{className:"mr-2",style:{color:e.placeMarkerColor}},c.createElement(v.Z,{icon:m.FG})),e.displayHeading||c.createElement("em",null,"Untitled section"))}))}),[L]);return(0,w.e)(n?10:0),c.createElement(s.Z,{direction:"down",isOpen:n,toggle:a},c.createElement(u.Z,{tag:"div"},c.createElement(E.ZP,(0,o.Z)({},x,{loading:j.mode===r.sections&&j.adding,clickEvent:P.j.clickSaveToDocButton,onClick:I,className:t}))),c.createElement(b.Z,{right:!0,positionFixed:!0,container:"body",modifiers:C(C({},k.F),{},{preventOverflow:{boundariesElement:"viewport"}})},j.mode===r.error?c.createElement(i.Z,{header:!0},c.createElement("span",{className:"text-danger"},"Error: ",j.message)):j.mode===r.loading?c.createElement(i.Z,{header:!0},c.createElement("span",{className:"mr-2"},c.createElement(g.Z,null)),"Loadingâ€¦"):j.mode===r.sections?c.createElement(c.Fragment,null,c.createElement(i.Z,{onClick:T,toggle:!1,className:"font-weight-bold py-2"},c.createElement(v.Z,{icon:p.ac,className:"mr-2"}),"Back"),c.createElement(i.Z,{divider:!0}),j.recentSection&&c.createElement(c.Fragment,null,c.createElement(i.Z,{header:!0},"Recently saved to"),_([j.recentSection]),c.createElement(i.Z,{divider:!0})),c.createElement(i.Z,{header:!0},"Sections",j.tripPlanTitle&&" of ".concat(j.tripPlanTitle)),_(j.sections)):c.createElement(c.Fragment,null,c.createElement(i.Z,{tag:d.rU,to:(0,Z.i)({type:S.u.plan,mapPlaceId:N||void 0}),className:"font-weight-bold py-2"},c.createElement("span",{className:"mr-2"},c.createElement(v.Z,{icon:f.r8})),"Create a new plan"),c.createElement(i.Z,{divider:!0}),0!==j.tripPlans.length?j.tripPlans.map((function(e){return c.createElement(i.Z,{key:e.key,onClick:F(e.key),toggle:!1,disabled:null!==j.loadingSectionsForKey},e.title," ",j.loadingSectionsForKey===e.key&&c.createElement(g.Z,{className:"ml-2"}))})):c.createElement(i.Z,{disabled:!0},"You don't have any plans or guides yet"))))})),I=function(){};t.Z=D}}]);